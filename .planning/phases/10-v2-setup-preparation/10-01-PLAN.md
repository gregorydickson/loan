---
phase: 10-v2-setup-preparation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/gpu-quota-request.md
autonomous: false

must_haves:
  truths:
    - "GPU quota status is known (either already sufficient or request submitted)"
    - "L4 GPU quota documented for us-central1 region"
  artifacts:
    - path: "docs/gpu-quota-request.md"
      provides: "GPU quota status documentation"
      contains: "quota"
  key_links: []
---

<objective>
Check GPU quota status and submit request if needed for L4 GPUs in Cloud Run.

Purpose: Phase 13 requires L4 GPUs for LightOnOCR service. GPU quota approval can take 24-48 hours, so this must happen first to avoid blocking future phases.
Output: GPU quota confirmed or request submitted, documented in docs/gpu-quota-request.md
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-v2-setup-preparation/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Check current GPU quota status</name>
  <files>docs/gpu-quota-request.md</files>
  <action>
Run gcloud commands to check current GPU quota for the project:

```bash
# Get project ID
PROJECT_ID=$(gcloud config get-value project)

# Check Cloud Run GPU quota in us-central1
gcloud run regions describe us-central1 --format="yaml"

# Check Compute Engine L4 GPU quotas
gcloud compute project-info describe --project=$PROJECT_ID \
    --format="table(quotas.filter(metric~NVIDIA))"

# Also check the specific Cloud Run GPU quota
gcloud compute regions describe us-central1 --project=$PROJECT_ID \
    --format="table(quotas.filter(metric~NVIDIA_L4_GPUS))" 2>/dev/null || echo "Cloud Run GPU quota check not available via this method"
```

Create docs/gpu-quota-request.md with:
- Current quota status
- Whether request is needed (new projects get auto-grant of 3 L4 GPUs)
- Region: us-central1
- GPU type: NVIDIA L4
- Required for: Phase 13 LightOnOCR GPU service

If quota is already >= 1 L4 GPU, document as "Sufficient - no request needed"
If quota is 0 or unclear, document that manual request is required.
  </action>
  <verify>docs/gpu-quota-request.md exists with quota status documented</verify>
  <done>GPU quota status checked and documented</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 2: Submit GPU quota request if needed</name>
  <what-built>GPU quota status check documented in docs/gpu-quota-request.md</what-built>
  <action>
If quota request is needed (documented in Task 1), submit via GCP Console:

1. Go to: https://console.cloud.google.com/iam-admin/quotas
2. Filter: "NvidiaL4GpuAllocNoZonalRedundancyPerProjectRegion"
3. Select region: us-central1
4. Click "Edit Quotas"
5. Request: 1 GPU (minimum for LightOnOCR service)
6. Justification: "LightOnOCR GPU service for document OCR processing"

Note: New projects often get auto-grant of 3 L4 GPUs immediately. Check email for approval confirmation.
  </action>
  <how-to-verify>
    1. Check docs/gpu-quota-request.md - if it says "Sufficient", skip this checkpoint
    2. If request needed, submit via console as described
    3. Check email for quota approval (may be immediate or take 24-48 hours)
  </how-to-verify>
  <resume-signal>
    Type one of:
    - "sufficient" - if quota was already sufficient
    - "requested" - if quota request submitted
    - "approved" - if quota request approved
  </resume-signal>
</task>

</tasks>

<verification>
- [ ] GPU quota status documented in docs/gpu-quota-request.md
- [ ] Region confirmed as us-central1
- [ ] Quota sufficient OR request submitted
</verification>

<success_criteria>
GPU quota status is known: either sufficient (>= 1 L4 GPU) or request submitted for L4 GPUs in us-central1 region.
</success_criteria>

<output>
After completion, create `.planning/phases/10-v2-setup-preparation/10-01-SUMMARY.md`
</output>
