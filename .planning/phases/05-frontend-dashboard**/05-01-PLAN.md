---
phase: 05-frontend-dashboard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/src/app/layout.tsx
  - frontend/src/app/page.tsx
  - frontend/src/components/providers.tsx
  - frontend/src/components/layout/sidebar.tsx
  - frontend/src/components/layout/header.tsx
  - frontend/src/lib/query-client.ts
  - frontend/src/lib/api/client.ts
  - frontend/src/lib/api/types.ts
  - frontend/src/lib/api/documents.ts
  - frontend/src/lib/api/borrowers.ts
autonomous: true

must_haves:
  truths:
    - "Navigation sidebar shows links to Documents, Borrowers, and Architecture pages"
    - "QueryClientProvider wraps the entire application for data fetching"
    - "API client can make typed requests to backend endpoints"
    - "Dashboard home page displays summary stats for documents and borrowers"
  artifacts:
    - path: "frontend/src/components/providers.tsx"
      provides: "QueryClientProvider wrapper (client component)"
      exports: ["Providers"]
    - path: "frontend/src/components/layout/sidebar.tsx"
      provides: "Navigation sidebar component"
      exports: ["Sidebar"]
    - path: "frontend/src/lib/api/client.ts"
      provides: "Base API fetch client"
      exports: ["apiClient", "API_BASE"]
    - path: "frontend/src/lib/api/types.ts"
      provides: "TypeScript types matching backend Pydantic models"
      exports: ["DocumentUploadResponse", "DocumentStatusResponse", "BorrowerSummary", "BorrowerDetailResponse"]
  key_links:
    - from: "frontend/src/app/layout.tsx"
      to: "frontend/src/components/providers.tsx"
      via: "Providers import and wrap children"
      pattern: "<Providers>"
    - from: "frontend/src/components/layout/sidebar.tsx"
      to: "next/link"
      via: "Link components for navigation"
      pattern: "Link.*href="
---

<objective>
Set up the frontend foundation with dependencies, layout components, and a type-safe API client.

Purpose: Establish the infrastructure (QueryClientProvider, layout shell, API layer) that all feature pages depend on.
Output: Working app shell with sidebar navigation, API client ready for use, and dependencies installed.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-frontend-dashboard**/05-RESEARCH.md

Reference existing files:
@frontend/package.json (current dependencies)
@frontend/src/app/layout.tsx (current layout)
@frontend/src/lib/utils.ts (existing utility)
@frontend/components.json (shadcn config)
@backend/src/api/documents.py (API response shapes)
@backend/src/api/borrowers.py (API response shapes)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and add shadcn components</name>
  <files>frontend/package.json</files>
  <action>
    Install required npm packages:
    ```bash
    cd frontend
    npm install @tanstack/react-query @tanstack/react-table react-dropzone mermaid zod date-fns
    ```

    Add shadcn/ui components needed for the dashboard:
    ```bash
    npx shadcn@latest add card table input dialog tabs badge skeleton progress separator
    ```

    These provide the UI primitives for all feature pages.
  </action>
  <verify>
    Run `npm ls @tanstack/react-query` - should show version installed.
    Verify `frontend/src/components/ui/card.tsx` exists after shadcn add.
  </verify>
  <done>package.json contains all dependencies; shadcn components exist in components/ui/</done>
</task>

<task type="auto">
  <name>Task 2: Create API client and TypeScript types</name>
  <files>
    frontend/src/lib/query-client.ts
    frontend/src/lib/api/client.ts
    frontend/src/lib/api/types.ts
    frontend/src/lib/api/documents.ts
    frontend/src/lib/api/borrowers.ts
  </files>
  <action>
    Create `lib/query-client.ts`:
    - Export QueryClient with staleTime: 60000 (1 min), retry: 1 for queries, retry: 0 for mutations

    Create `lib/api/client.ts`:
    - Export API_BASE from NEXT_PUBLIC_API_URL env var, default "http://localhost:8000"
    - Export async function apiClient<T>(path, options?) that:
      - Fetches from `${API_BASE}${path}`
      - Throws Error with detail message on non-ok response
      - Returns typed JSON response

    Create `lib/api/types.ts` matching backend Pydantic models:
    - DocumentUploadResponse: id, filename, file_hash, file_size_bytes, status, page_count, error_message, message
    - DocumentStatusResponse: id, status, page_count, error_message
    - DocumentResponse: id, filename, file_hash, file_type, file_size_bytes, gcs_uri, status, error_message, page_count
    - DocumentListResponse: documents[], total, limit, offset
    - BorrowerSummary: id, name, confidence_score (string), created_at, income_count
    - BorrowerListResponse: borrowers[], total, limit, offset
    - IncomeRecord: id, amount (string), period, year, source_type, employer
    - AccountNumber: id, number, account_type
    - SourceReference: id, document_id, page_number, section, snippet
    - BorrowerDetailResponse: id, name, address_json, confidence_score, created_at, income_records[], account_numbers[], source_references[]
    - DocumentStatus type: "pending" | "processing" | "completed" | "failed"

    Create `lib/api/documents.ts`:
    - uploadDocument(formData: FormData): POST /api/documents/ - DO NOT set Content-Type header
    - getDocumentStatus(id: string): GET /api/documents/{id}/status
    - getDocument(id: string): GET /api/documents/{id}
    - listDocuments(limit?, offset?): GET /api/documents/

    Create `lib/api/borrowers.ts`:
    - listBorrowers(limit?, offset?): GET /api/borrowers/
    - searchBorrowers(params): GET /api/borrowers/search with name or account_number
    - getBorrower(id: string): GET /api/borrowers/{id}
    - getBorrowerSources(id: string): GET /api/borrowers/{id}/sources
  </action>
  <verify>
    TypeScript compilation: `cd frontend && npx tsc --noEmit` passes without type errors.
  </verify>
  <done>API client exports typed functions for all backend endpoints</done>
</task>

<task type="auto">
  <name>Task 3: Create layout components and update app shell</name>
  <files>
    frontend/src/components/providers.tsx
    frontend/src/components/layout/sidebar.tsx
    frontend/src/components/layout/header.tsx
    frontend/src/app/layout.tsx
    frontend/src/app/page.tsx
  </files>
  <action>
    Create `components/providers.tsx` (client component):
    - "use client" directive
    - Import QueryClientProvider from @tanstack/react-query
    - Import queryClient from @/lib/query-client
    - Export Providers component that wraps children with QueryClientProvider

    Create `components/layout/sidebar.tsx` (client component for active state):
    - "use client" directive
    - Use next/link for navigation
    - Links: Documents (/documents), Borrowers (/borrowers), Architecture (/architecture)
    - Use lucide-react icons: FileText, Users, BookOpen
    - Style with Tailwind: fixed left sidebar, w-64, bg-background, border-r
    - Highlight active link using usePathname()

    Create `components/layout/header.tsx`:
    - Page title display area
    - Responsive: hidden on mobile (sidebar handles nav)

    Update `app/layout.tsx`:
    - Wrap children with Providers component
    - Add Sidebar to the layout (flex container)
    - Main content area with left margin for sidebar (ml-64)
    - Keep existing Inter font and metadata

    Update `app/page.tsx` (dashboard home):
    - "use client" directive (needed for hooks)
    - Import useDocuments from hooks/use-documents and useBorrowers from hooks/use-borrowers
    - Display summary stats in Card components:
      - Total Documents: show documents.total from useDocuments hook (or 0 if loading)
      - Total Borrowers: show borrowers.total from useBorrowers hook (or 0 if loading)
      - Recent Uploads: show count of documents with status "pending" or "processing"
    - Welcome message: "Loan Document Intelligence Dashboard"
    - Quick action links to Documents and Borrowers sections
    - Show Skeleton while data is loading
    - Use Card component from shadcn/ui with CardHeader, CardTitle, CardContent

    Note: The hooks (useDocuments, useBorrowers) will be created in Plans 02 and 03.
    For now, create placeholder imports that will be satisfied when those plans complete.
    Alternatively, call the API functions directly if hooks aren't available yet.
  </action>
  <verify>
    Run `npm run dev` and navigate to http://localhost:3000:
    - Sidebar visible with Documents, Borrowers, Architecture links
    - Dashboard home shows stats cards (may show 0 or loading until backend runs)
    - Page renders without errors
    - Console shows no QueryClient errors
  </verify>
  <done>App shell renders with sidebar navigation, QueryClientProvider wrapper, and dashboard home with summary stats</done>
</task>

</tasks>

<verification>
1. `npm run dev` starts without errors
2. Browser shows sidebar with navigation links
3. Dashboard home page displays summary stats cards (total documents, total borrowers, recent uploads)
4. Clicking sidebar links navigates (pages may show 404 until created)
5. No console errors about QueryClient
6. `npx tsc --noEmit` passes in frontend directory
</verification>

<success_criteria>
- All npm dependencies installed (TanStack Query, react-dropzone, mermaid, etc.)
- shadcn/ui components added (card, table, input, badge, etc.)
- QueryClientProvider wraps application
- Sidebar shows Documents, Borrowers, Architecture navigation
- Dashboard home page displays summary stats (total documents, total borrowers, recent uploads)
- API client exports typed functions for documents and borrowers endpoints
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-frontend-dashboard**/05-01-SUMMARY.md`
</output>
